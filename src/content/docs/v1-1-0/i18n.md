---
title: "Internacionalizaci√≥n"
description: "Soporte multi-idioma: ingl√©s y espa√±ol, resoluci√≥n lazy, 160+ keys traducidas."
icon: "M3 5h12M9 3v2m6-2v2M9 19h6m-6-7h6m-6 4h6M5 7h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2z"
order: 29
---

# Internacionalizaci√≥n (i18n)

Architect CLI soporta **ingl√©s** (default) y **espa√±ol** para todos los mensajes generados por el sistema: logs humanos, prompts de agentes, reportes, guardrails y evaluaciones.

> **v1.1.0**: Los mensajes del sistema ahora est√°n en ingl√©s por defecto. Se puede cambiar a espa√±ol via configuraci√≥n.

---

## Configuraci√≥n

### Via YAML

```yaml
# config.yaml (o .architect.yaml)
language: es   # "en" (default) | "es"
```

### Via variable de entorno

```bash
export ARCHITECT_LANGUAGE=es
```

### Via c√≥digo (para extensiones)

```python
from architect.i18n import set_language, get_language

set_language("es")
print(get_language())  # "es"
```

### Precedencia

```
1. Defaults del c√≥digo ‚Üí "en"
        ‚Üì
2. Archivo YAML ‚Üí language: es
        ‚Üì
3. Variable de entorno ‚Üí ARCHITECT_LANGUAGE=es
```

---

## Qu√© cambia con el idioma

| Componente | Afectado por `language` | Ejemplo EN | Ejemplo ES |
|------------|------------------------|------------|------------|
| **Logs HUMAN** (stderr) | S√≠ | `Step 1 ‚Üí LLM call` | `Paso 1 ‚Üí Llamada al LLM` |
| **Agent prompts** (system) | S√≠ | `You are a careful executor...` | `Eres un ejecutor cuidadoso...` |
| **Reportes** (markdown/JSON) | S√≠ | `## Code Health Delta` | `## Delta de Salud del C√≥digo` |
| **Guardrails messages** | S√≠ | `Sensitive file blocked...` | `Archivo sensible bloqueado...` |
| **Close instructions** | S√≠ | `Your budget is exhausted...` | `Tu presupuesto se ha agotado...` |
| **Context summaries** | S√≠ | `[Summary of previous steps]` | `[Resumen de pasos anteriores]` |
| **Self-evaluator prompts** | S√≠ | `Original task:` | `Tarea original:` |
| **Ralph Loop progress** | S√≠ | `# Ralph Loop ‚Äî Progress` | `# Ralph Loop ‚Äî Progreso` |
| **CLI help/flags** | **No** | `--mode yolo` | `--mode yolo` |
| **User prompts** | **No** | (sin cambio) | (sin cambio) |
| **Error messages (CLI)** | **No** | (siempre ingl√©s) | (siempre ingl√©s) |

---

## Qu√© NO cambia

- **CLI help text**: `architect --help`, `architect run --help`, etc. siempre est√°n en ingl√©s.
- **Prompts del usuario**: el texto que el usuario escribe no se traduce.
- **Skills y `.architect.md`**: el contenido de los archivos del proyecto no se traduce.
- **Nombres de archivos**: `SKILL.md`, `memory.md`, etc. mantienen sus nombres.
- **Formato JSON de salida**: las claves JSON (`status`, `final_output`, etc.) no cambian.

---

## Arquitectura

### M√≥dulo `src/architect/i18n/`

```
src/architect/i18n/
‚îú‚îÄ‚îÄ __init__.py    # API p√∫blica: t(), set_language(), get_language(), get_prompt()
‚îú‚îÄ‚îÄ registry.py    # LanguageRegistry ‚Äî singleton thread-safe con fallback chain
‚îú‚îÄ‚îÄ en.py          # Strings en ingl√©s (can√≥nico, ~160 keys)
‚îî‚îÄ‚îÄ es.py          # Strings en espa√±ol (~160 keys)
```

### API p√∫blica

| Funci√≥n | Descripci√≥n |
|---------|-------------|
| `t(key, **kwargs)` | Traduce una key con interpolaci√≥n opcional |
| `get_prompt(key)` | Obtiene un prompt multilinea para el idioma actual |
| `set_language(lang)` | Establece el idioma activo (`"en"` o `"es"`) |
| `get_language()` | Retorna el c√≥digo del idioma actual |

### Cadena de fallback

Cuando se busca una key, el registry sigue esta cadena:

```
idioma actual ‚Üí ingl√©s (fallback) ‚Üí key cruda (√∫ltimo recurso)
```

Esto garantiza que nunca se rompe la aplicaci√≥n aunque falte una traducci√≥n: si una key no existe en espa√±ol, se usa la versi√≥n inglesa. Si tampoco existe en ingl√©s, se retorna la key como string.

### Resoluci√≥n lazy

Todas las traducciones se resuelven **en runtime**, no en import-time. Esto es cr√≠tico porque `set_language()` se llama despu√©s de que los m√≥dulos se importen (cuando se carga la configuraci√≥n del usuario).

Los mecanismos lazy incluyen:

- **`_PromptProxy`** en `agents/prompts.py`: `DEFAULT_PROMPTS["build"]` resuelve via `get_prompt()` en cada acceso.
- **`_LazyAgentDict`** en `agents/registry.py`: `DEFAULT_AGENTS["build"]` construye el AgentConfig con el prompt del idioma actual.
- **`_LazyPrompt`** y **`_LazyStr`**: wrappers para `REVIEW_SYSTEM_PROMPT` y `BUILD_PROMPT` que resuelven en `.format()` o `str()`.

---

## Namespaces de keys

Las ~160 keys est√°n organizadas en 14 namespaces:

| Namespace | Keys | Qu√© cubre |
|-----------|------|-----------|
| `human.*` | ~41 | HumanFormatter: logs de pasos, tools, safety nets, pipeline, ralph, reviewer, parallel, competitive, contexto |
| `competitive.*` | ~17 | Reporte de evaluaci√≥n competitiva: headers, ranking, detalles |
| `ralph.*` | ~16 | Progreso de iteraciones, prompts de especificaci√≥n |
| `eval.*` | ~15 | Self-evaluator: prompt del sistema, labels, correcciones |
| `health.*` | ~14 | Delta de salud del c√≥digo: t√≠tulo, headers, m√©tricas |
| `dispatch.*` | ~13 | Sub-agentes: prompts, instrucciones, tipos |
| `guardrail.*` | ~10 | Mensajes de bloqueo: sensible, protegido, comandos, l√≠mites |
| `context.*` | ~9 | Resumen de contexto, headers, mensajes de omisi√≥n |
| `pipeline.*` | ~7 | Validaci√≥n de pipeline YAML: errores |
| `close.*` | ~5 | Instrucciones de cierre: budget, max_steps, timeout, context_full, interrupt |
| `prompt.*` | ~5 | System prompts de agentes: build, plan, resume, review |
| `reviewer.*` | ~5 | Auto-reviewer: prompt del sistema, labels |
| `dryrun.*` | ~3 | Resumen de dry-run: headers, labels |
| `misc.*` | ‚Äî | Headers de skills, labels de pipeline |

---

## Ejemplo de uso

### Cambiar idioma en config

```yaml
# config.yaml
language: es

llm:
  model: gpt-4o
```

```bash
architect run "analiza el proyecto" --mode yolo
# Los logs en stderr se muestran en espa√±ol:
# üîÑ Paso 1 ‚Üí Llamada al LLM (5 mensajes)
#    ‚úì LLM respondi√≥ con 2 tool calls
# ...
# ‚úÖ Agente completado (3 pasos)
```

### Cambiar idioma con env var

```bash
ARCHITECT_LANGUAGE=es architect run "analiza el proyecto" --mode yolo
```

### Verificar idioma por c√≥digo

```python
from architect.i18n import t, set_language

# English (default)
print(t("human.llm_call", step=1, messages=5))
# ‚Üí "\nüîÑ Step 1 ‚Üí LLM call (5 messages)"

set_language("es")
print(t("human.llm_call", step=1, messages=5))
# ‚Üí "\nüîÑ Paso 1 ‚Üí Llamada al LLM (5 mensajes)"
```

---

## A√±adir un nuevo idioma

Para a√±adir soporte de un tercer idioma (por ejemplo, franc√©s):

### 1. Crear el archivo de strings

```python
# src/architect/i18n/fr.py
"""French language strings for architect-cli."""

STRINGS: dict[str, str] = {
    "human.llm_call": "\nüîÑ √âtape {step} ‚Üí Appel LLM ({messages} messages)",
    "human.llm_response_tools": "   ‚úì LLM a r√©pondu avec {count} appel{s} d'outil",
    # ... todas las ~160 keys
}
```

### 2. Registrar en el registry

```python
# src/architect/i18n/registry.py ‚Äî en _load_defaults()
def _load_defaults(self):
    from . import en, es, fr
    self._languages["en"] = en.STRINGS
    self._languages["es"] = es.STRINGS
    self._languages["fr"] = fr.STRINGS
```

### 3. Actualizar el schema de config

```python
# src/architect/config/schema.py
class AppConfig(BaseModel):
    language: Literal["en", "es", "fr"] = "en"
```

### 4. Verificar paridad de keys

```python
from architect.i18n.en import STRINGS as EN
from architect.i18n.fr import STRINGS as FR

missing = set(EN) - set(FR)
extra = set(FR) - set(EN)
assert not missing, f"Missing in FR: {missing}"
assert not extra, f"Extra in FR: {extra}"
```

---

## Archivos relacionados

| Archivo | Rol |
|---------|-----|
| `src/architect/i18n/__init__.py` | API p√∫blica |
| `src/architect/i18n/registry.py` | LanguageRegistry singleton |
| `src/architect/i18n/en.py` | Strings ingl√©s (~160 keys) |
| `src/architect/i18n/es.py` | Strings espa√±ol (~160 keys) |
| `src/architect/config/schema.py` | Campo `language: Literal["en", "es"]` en AppConfig |
| `src/architect/config/loader.py` | Lectura de `ARCHITECT_LANGUAGE` env var |
| `src/architect/cli.py` | `set_language(config.language)` al inicio |
| `tests/test_i18n/test_i18n.py` | ~25 tests del sistema i18n |
